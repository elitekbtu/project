# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –≤–µ—á–µ—Ä–∏–Ω–æ–∫

## –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª, —á—Ç–æ –∑–∞–ø—Ä–æ—Å—ã —Ç–∏–ø–∞ "—á—Ç–æ –º–æ–∂–Ω–æ –æ–¥–µ—Ç—å –Ω–∞ –≤–µ—á–µ—Ä–∏–Ω–∫—É" –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç —Ç–æ–≤–∞—Ä—ã, —Ö–æ—Ç—è –∑–∞–ø—Ä–æ—Å "—Ñ—É—Ç–±–æ–ª–∫–∏" —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ.

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

1. **–°–∏—Å—Ç–µ–º–∞ –∏—Å–∫–∞–ª–∞ —Ç–æ–ª—å–∫–æ –ø–ª–∞—Ç—å—è** –¥–ª—è –≤–µ—á–µ—Ä–∏–Ω–æ–∫
2. **–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –Ω–µ –±—ã—Ç—å –ø–ª–∞—Ç—å–µ–≤** –∏–ª–∏ –æ–Ω–∏ –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç –ø–æ–¥ —Ñ–∏–ª—å—Ç—Ä—ã
3. **Fallback –ø–æ–∏—Å–∫ –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª —Å–ø–µ—Ü–∏—Ñ–∏–∫—É –≤–µ—á–µ—Ä–∏–Ω–æ–∫**
4. **–¶–µ–Ω–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –±—ã–ª —Å–ª–∏—à–∫–æ–º —É–∑–∫–∏–º** (10-50 —Ç—ã—Å—è—á)

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –£–ª—É—á—à–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –≤–µ—á–µ—Ä–∏–Ω–æ–∫

```python
# –ë–´–õ–û:
return {
    'category': '–ø–ª–∞—Ç—å–µ',  # –¢–æ–ª—å–∫–æ –ø–ª–∞—Ç—å—è
    'price_range': {'min': 10000, 'max': 50000},
    'limit': 10
}

# –°–¢–ê–õ–û:
return {
    'category': None,  # –ù–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
    'price_range': {'min': 5000, 'max': 50000},  # –†–∞—Å—à–∏—Ä—è–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω
    'limit': 15,  # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ª–∏–º–∏—Ç
    'party_request': True,  # –§–ª–∞–≥ –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
}
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ fallback –ø–æ–∏—Å–∫

```python
# –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –≤–µ—á–µ—Ä–∏–Ω–æ–∫
if request_params.get('party_request'):
    # –ò—â–µ–º —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –¥–ª—è –≤–µ—á–µ—Ä–∏–Ω–æ–∫
    party_keywords = ['–ø–ª–∞—Ç—å–µ', '—Ä—É–±–∞—à–∫–∞', '–∫–æ—Å—Ç—é–º', '—ç–ª–µ–≥–∞–Ω—Ç–Ω', '—Å—Ç–∏–ª—å–Ω', '–ø—Ä–µ–º–∏—É–º']
    
    for keyword in party_keywords:
        party_conditions.append(Item.name.ilike(f"%{keyword}%"))
    
    if party_conditions:
        query = query.filter(or_(*party_conditions))
    
    # –ï—Å–ª–∏ –¥–ª—è –≤–µ—á–µ—Ä–∏–Ω–∫–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ª—é–±—ã–µ —Ç–æ–≤–∞—Ä—ã
    if not result:
        query = db.query(Item)
        result = query.order_by(Item.price.desc()).limit(limit).all()
```

### 3. –£–ª—É—á—à–µ–Ω AI-–æ—Ç–≤–µ—Ç –¥–ª—è –≤–µ—á–µ—Ä–∏–Ω–æ–∫

```python
# –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –≤–µ—á–µ—Ä–∏–Ω–æ–∫
if request_params.get('party_request') and not all_items:
    reply = (
        "–û–π, –∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–µ –Ω–∞—à–ª–∞ —Ç–æ–≤–∞—Ä—ã –ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É üòî –ù–æ –Ω–µ —Ä–∞—Å—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ—Å—å! "
        "–î–ª—è –≤–µ—á–µ—Ä–∏–Ω–∫–∏ –º–æ–≥—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å:\n\n"
        "üéâ **–≠–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ —Ñ—É—Ç–±–æ–ª–∫–∏** - –æ—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã—Ö –≤–µ—á–µ—Ä–∏–Ω–æ–∫\n"
        "üëî **–°—Ç–∏–ª—å–Ω—ã–µ —Ä—É–±–∞—à–∫–∏** - –ø–æ–¥–æ–π–¥—É—Ç –¥–ª—è –±–æ–ª–µ–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π\n"
        "üëó **–õ—é–±—ã–µ –Ω–∞—Ä—è–¥–Ω—ã–µ –≤–µ—â–∏** - –≥–ª–∞–≤–Ω–æ–µ —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ!\n\n"
        "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∏—Å–∫–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: '–ø–æ–∫–∞–∂–∏ —Ñ—É—Ç–±–æ–ª–∫–∏', '–Ω—É–∂–Ω—ã —Ä—É–±–∞—à–∫–∏' –∏–ª–∏ '—Å—Ç–∏–ª—å–Ω–∞—è –æ–¥–µ–∂–¥–∞'"
    )
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

1. ‚úÖ **"—á—Ç–æ –º–æ–∂–Ω–æ –æ–¥–µ—Ç—å –Ω–∞ –≤–µ—á–µ—Ä–∏–Ω–∫—É"** ‚Üí –∏—â–µ—Ç —ç–ª–µ–≥–∞–Ω—Ç–Ω—É—é –æ–¥–µ–∂–¥—É (–ø–ª–∞—Ç—å—è, —Ä—É–±–∞—à–∫–∏, –∫–æ—Å—Ç—é–º—ã)
2. ‚úÖ **–ï—Å–ª–∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–π –æ–¥–µ–∂–¥—ã –Ω–µ—Ç** ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª—é–±—ã–µ —Ç–æ–≤–∞—Ä—ã —Å —Å–æ–≤–µ—Ç–æ–º
3. ‚úÖ **–†–∞—Å—à–∏—Ä–µ–Ω —Ü–µ–Ω–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω** ‚Üí 5-50 —Ç—ã—Å—è—á –≤–º–µ—Å—Ç–æ 10-50 —Ç—ã—Å—è—á
4. ‚úÖ **–£–≤–µ–ª–∏—á–µ–Ω –ª–∏–º–∏—Ç –ø–æ–∏—Å–∫–∞** ‚Üí 15 —Ç–æ–≤–∞—Ä–æ–≤ –≤–º–µ—Å—Ç–æ 10
5. ‚úÖ **–£–ª—É—á—à–µ–Ω AI-–æ—Ç–≤–µ—Ç** ‚Üí –¥–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–æ–≤–µ—Ç—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç `test_party_search.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
- –ü–∞—Ä—Å–∏–Ω–≥–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –≤–µ—á–µ—Ä–∏–Ω–æ–∫
- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤
- –£—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ñ–ª–∞–≥–∞ `party_request`

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:

- ‚úÖ **"—á—Ç–æ –º–æ–∂–Ω–æ –æ–¥–µ—Ç—å –Ω–∞ –≤–µ—á–µ—Ä–∏–Ω–∫—É"** ‚Üí –Ω–∞–π–¥–µ—Ç —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –∏–ª–∏ –¥–∞—Å—Ç –ø–æ–ª–µ–∑–Ω—ã–π —Å–æ–≤–µ—Ç
- ‚úÖ **"–≤–µ—á–µ—Ä–∏–Ω–∫–µ"** ‚Üí —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
- ‚úÖ **"–ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π –Ω–∞—Ä—è–¥"** ‚Üí –±—É–¥–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω –∫–∞–∫ –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤–µ—á–µ—Ä–∏–Ω–∫–∏
- ‚úÖ **Fallback —Ä–∞–±–æ—Ç–∞–µ—Ç** ‚Üí –µ—Å–ª–∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–π –æ–¥–µ–∂–¥—ã –Ω–µ—Ç, –ø–æ–∫–∞–∂–µ—Ç –ª—é–±—ã–µ —Ç–æ–≤–∞—Ä—ã

üéâ **–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –≤–µ—á–µ—Ä–∏–Ω–æ–∫ –¥–æ–ª–∂–µ–Ω —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!** 