import{j as e}from"./ui-DmaJfU4R.js";import{r as c}from"./router-YsGj19cs.js";import{B as M}from"./button-CEL2MslA.js";import{C as a,a as r,b as x,d as l,c as q}from"./card-hWJdfOrY.js";import{B as i}from"./badge-CMy5sMNA.js";import{u as I}from"./use-toast-BimaNeed.js";import{c as g}from"./index-dk87i_EB.js";import{c as f}from"./utils-CytzSlOG.js";import{L as S}from"./loader-circle-yzSCNo-f.js";import{m as X}from"./proxy-OF6tZF67.js";import{R as F}from"./refresh-cw-uUutlnOJ.js";import{S as u}from"./shield-BvU7hRXJ.js";import{U as p,L as G}from"./users-DdDp9SKl.js";import{P as E}from"./package-Mme0kKEa.js";import{c as L}from"./createLucideIcon-BcwDLXBm.js";import{H as N}from"./heart-DyjZq6UA.js";import{C as J,a as K}from"./circle-x-DfXG8zVP.js";import{Z as O,B as Q}from"./zap-B6DnQTV_.js";import"./vendor-BtP0CW_r.js";import"./index-BwobEAja.js";/**
 * @license lucide-react v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=L("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=L("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Y=async()=>(await g.get("/api/system/analytics")).data,$=async()=>(await g.get("/api/system/health")).data,ee=async()=>(await g.get("/api/system/performance")).data,ye=()=>{const[t,A]=c.useState(null),[o,D]=c.useState(null),[h,B]=c.useState(null),[R,v]=c.useState(!0),[y,w]=c.useState(!1),[m,j]=c.useState("overview"),[H,b]=c.useState(!1),[P,_]=c.useState(!1),{toast:T}=I(),k=async(s=!1)=>{var n,C;try{s?w(!0):v(!0),b(!1),_(!1);const[d,z,Z]=await Promise.all([Y(),$(),ee()]);A(d),D(z),B(Z)}catch(d){((n=d==null?void 0:d.response)==null?void 0:n.status)===401||((C=d==null?void 0:d.response)==null?void 0:C.status)===403?b(!0):_(!0),T({variant:"destructive",title:"Ошибка",description:"Не удалось загрузить системную аналитику"})}finally{v(!1),w(!1)}};c.useEffect(()=>{k()},[]);const U=()=>{k(!0)};return R?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx(S,{className:"h-8 w-8 animate-spin text-primary"})}):H?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("p",{className:"text-red-500 text-lg font-semibold",children:"Нет доступа. Войдите как администратор."})}):P?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("p",{className:"text-red-500 text-lg font-semibold",children:"Ошибка сервера. Обратитесь к разработчику."})}):!t||!o||!h?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Не удалось загрузить данные"})}):e.jsxs(X.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight text-foreground",children:"Системная аналитика"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Полный анализ системы и мониторинг производительности"})]}),e.jsxs(M,{onClick:U,disabled:y,variant:"outline",className:"flex items-center gap-2 w-full sm:w-auto",children:[y?e.jsx(S,{className:"h-4 w-4 animate-spin"}):e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Обновить"}),e.jsx("span",{className:"sm:hidden",children:"Обновить"})]})]}),e.jsxs(a,{className:"border-l-4 border-l-green-500",children:[e.jsx(r,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),"Состояние системы"]})}),e.jsx(l,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5 text-blue-500"}),e.jsxs("span",{className:"font-medium text-sm sm:text-base",children:["Пользователей: ",o.users_count]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5 text-purple-500"}),e.jsxs("span",{className:"font-medium text-sm sm:text-base",children:["Товаров: ",o.items_count]})]})]})})]}),e.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap space-y-1 sm:space-y-0 sm:space-x-1 bg-muted p-1 rounded-lg",children:[e.jsxs("button",{onClick:()=>j("overview"),className:f("flex-1 px-2 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors",m==="overview"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsx("span",{className:"hidden sm:inline",children:"Обзор"}),e.jsx("span",{className:"sm:hidden",children:"Обзор"})]}),e.jsxs("button",{onClick:()=>j("users"),className:f("flex-1 px-2 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors",m==="users"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsx("span",{className:"hidden sm:inline",children:"Пользователи"}),e.jsx("span",{className:"sm:hidden",children:"Пользователи"})]}),e.jsxs("button",{onClick:()=>j("content"),className:f("flex-1 px-2 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors",m==="content"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsx("span",{className:"hidden sm:inline",children:"Контент"}),e.jsx("span",{className:"sm:hidden",children:"Контент"})]}),e.jsxs("button",{onClick:()=>j("performance"),className:f("flex-1 px-2 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors",m==="performance"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsx("span",{className:"hidden sm:inline",children:"Производительность"}),e.jsx("span",{className:"sm:hidden",children:"Производительность"})]})]}),m==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsx(a,{children:e.jsx(l,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Всего пользователей"}),e.jsx("p",{className:"text-xl sm:text-3xl font-bold",children:t.system_info.total_users}),e.jsxs("p",{className:"text-xs sm:text-sm text-green-600",children:["+",t.system_info.new_users_month," за месяц"]})]}),e.jsx(p,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-500"})]})})}),e.jsx(a,{children:e.jsx(l,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Всего товаров"}),e.jsx("p",{className:"text-xl sm:text-3xl font-bold",children:t.content_stats.total_items}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:[t.content_stats.items_with_price," с ценами"]})]}),e.jsx(E,{className:"h-6 w-6 sm:h-8 sm:w-8 text-purple-500"})]})})}),e.jsx(a,{children:e.jsx(l,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Всего образов"}),e.jsx("p",{className:"text-xl sm:text-3xl font-bold",children:t.content_stats.total_outfits}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:[t.content_stats.public_outfits," публичных"]})]}),e.jsx(G,{className:"h-6 w-6 sm:h-8 sm:w-8 text-green-500"})]})})}),e.jsx(a,{children:e.jsx(l,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Активность"}),e.jsx("p",{className:"text-xl sm:text-3xl font-bold",children:t.activity_stats.total_views}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"просмотров"})]}),e.jsx(V,{className:"h-6 w-6 sm:h-8 sm:w-8 text-orange-500"})]})})})]}),e.jsxs(a,{children:[e.jsxs(r,{children:[e.jsx(x,{className:"text-lg sm:text-xl",children:"Активность за последние 7 дней"}),e.jsx(q,{className:"text-sm",children:"Просмотры и избранное по дням"})]}),e.jsx(l,{children:e.jsx("div",{className:"space-y-4",children:t.daily_activity.reverse().map(s=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium text-sm sm:text-base",children:new Date(s.date).toLocaleDateString("ru-RU")}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{className:"text-sm sm:text-base",children:s.views})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"text-sm sm:text-base",children:s.favorites})]})]})]},s.date))})})]})]}),m==="users"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(x,{className:"text-lg sm:text-xl",children:"Статистика пользователей"})}),e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm sm:text-base",children:"Всего пользователей"}),e.jsx(i,{variant:"outline",className:"text-xs sm:text-sm",children:t.system_info.total_users})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm sm:text-base",children:"Активных пользователей"}),e.jsx(i,{variant:"outline",className:"text-xs sm:text-sm",children:t.system_info.active_users})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm sm:text-base",children:"Модераторов"}),e.jsx(i,{variant:"outline",className:"text-xs sm:text-sm",children:t.system_info.moderators})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm sm:text-base",children:"Администраторов"}),e.jsx(i,{variant:"outline",className:"text-xs sm:text-sm",children:t.system_info.admins})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm sm:text-base",children:"Новых за месяц"}),e.jsx(i,{variant:"outline",className:"text-xs sm:text-sm text-green-600",children:t.system_info.new_users_month})]})]})})]}),e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(x,{className:"text-lg sm:text-xl",children:"Статистика модераторов"})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-3",children:t.moderator_stats.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:"font-medium text-sm sm:text-base truncate",children:s.name}),s.is_active?e.jsx(J,{className:"h-4 w-4 text-green-500 flex-shrink-0"}):e.jsx(K,{className:"h-4 w-4 text-red-500 flex-shrink-0"})]}),e.jsxs(i,{variant:"outline",className:"text-xs sm:text-sm flex-shrink-0",children:[s.items_count," товаров"]})]},s.user_id))})})]})]})}),m==="content"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(x,{className:"text-lg sm:text-xl",children:"Топ категорий"})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-3",children:t.top_categories.slice(0,8).map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-full bg-blue-500/20 flex items-center justify-center text-xs font-medium flex-shrink-0",children:n+1}),e.jsx("span",{className:"font-medium text-sm sm:text-base truncate",children:s.category})]}),e.jsx(i,{variant:"outline",className:"text-xs sm:text-sm flex-shrink-0",children:s.count})]},s.category))})})]}),e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(x,{className:"text-lg sm:text-xl",children:"Топ брендов"})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-3",children:t.top_brands.slice(0,8).map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-full bg-green-500/20 flex items-center justify-center text-xs font-medium flex-shrink-0",children:n+1}),e.jsx("span",{className:"font-medium text-sm sm:text-base truncate",children:s.brand})]}),e.jsx(i,{variant:"outline",className:"text-xs sm:text-sm flex-shrink-0",children:s.count})]},s.brand))})})]}),e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(x,{className:"text-lg sm:text-xl",children:"Популярные товары"})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-3",children:t.popular_items.slice(0,5).map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-full bg-red-500/20 flex items-center justify-center text-xs font-medium flex-shrink-0",children:n+1}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("span",{className:"font-medium text-sm sm:text-base truncate block",children:s.name}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",children:s.brand})]})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx(N,{className:"h-4 w-4 text-red-500"}),e.jsx(i,{variant:"outline",className:"text-xs sm:text-sm",children:s.likes})]})]},s.id))})})]}),e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(x,{className:"text-lg sm:text-xl",children:"Популярные образы"})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-3",children:t.popular_outfits.slice(0,5).map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-full bg-purple-500/20 flex items-center justify-center text-xs font-medium flex-shrink-0",children:n+1}),e.jsx("span",{className:"font-medium text-sm sm:text-base truncate",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx(N,{className:"h-4 w-4 text-red-500"}),e.jsx(i,{variant:"outline",className:"text-xs sm:text-sm",children:s.likes})]})]},s.id))})})]})]})}),m==="performance"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsx(a,{children:e.jsx(l,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Запросов/час"}),e.jsx("p",{className:"text-xl sm:text-3xl font-bold",children:h.requests_per_hour})]}),e.jsx(O,{className:"h-6 w-6 sm:h-8 sm:w-8 text-yellow-500"})]})})}),e.jsx(a,{children:e.jsx(l,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Активных пользователей/час"}),e.jsx("p",{className:"text-xl sm:text-3xl font-bold",children:h.active_users_hour})]}),e.jsx(p,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-500"})]})})}),e.jsx(a,{children:e.jsx(l,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"База данных"}),e.jsx("p",{className:"text-xl sm:text-3xl font-bold",children:o.database==="connected"?"healthy":"disconnected"}),o.database==="connected"&&e.jsxs("span",{className:"text-xs sm:text-sm text-muted-foreground",children:["Соединений: ",h.database_connections]})]}),o.database==="connected"?e.jsx(u,{className:"h-6 w-6 sm:h-8 sm:w-8 text-green-500"}):e.jsx(u,{className:"h-6 w-6 sm:h-8 sm:w-8 text-red-500"})]})})}),e.jsx(a,{children:e.jsx(l,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Память"}),e.jsx("p",{className:"text-xl sm:text-3xl font-bold",children:h.memory_usage})]}),e.jsx(Q,{className:"h-6 w-6 sm:h-8 sm:w-8 text-purple-500"})]})})})]}),e.jsxs(a,{children:[e.jsx(r,{children:e.jsx(x,{className:"text-lg sm:text-xl",children:"Статистика активности"})}),e.jsx(l,{children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:t.activity_stats.total_views}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Просмотров"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-red-600",children:t.activity_stats.total_favorites}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Избранных товаров"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:t.activity_stats.total_outfit_favorites}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Избранных образов"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-purple-600",children:t.activity_stats.total_comments}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Комментариев"})]})]})})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:["Данные обновлены: ",new Date(t.generated_at).toLocaleString("ru-RU")]})})]})};export{ye as default};
