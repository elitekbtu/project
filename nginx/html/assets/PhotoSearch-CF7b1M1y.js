import{j as s}from"./ui-DmaJfU4R.js";import{r as i,L as x}from"./router-YsGj19cs.js";import{c as f,A as g}from"./index-8jId_CL5.js";import{U as j}from"./user-photo-upload-G-1li__p.js";import{C as y,d as w}from"./card-hWJdfOrY.js";import"./vendor-BtP0CW_r.js";import"./button-CEL2MslA.js";import"./index-BwobEAja.js";import"./utils-CytzSlOG.js";import"./use-toast-BimaNeed.js";import"./x-DBAcYj4I.js";import"./createLucideIcon-BcwDLXBm.js";import"./upload-CEja7h-0.js";import"./user-BuBPZYTe.js";const b=async(n,a)=>{const e=new FormData;return e.append("file",n),a&&e.append("user_profile",JSON.stringify(a)),(await f.post("/api/items/search-by-photo",e,{headers:{"Content-Type":"multipart/form-data"}})).data},J=()=>{const[n,a]=i.useState(),[e,c]=i.useState([]),[m,p]=i.useState(!1),o=i.useContext(g),t=o&&typeof o=="object"&&o!==null&&"user"in o?o.user:void 0,l=async(r,d)=>{if(a(r),d){p(!0);try{const h=t?{height:t.height,weight:t.weight,chest:t.chest,waist:t.waist,hips:t.hips}:void 0,u=await b(d,h);c(u)}catch(h){console.error("Error searching by photo:",h),c([])}finally{p(!1)}}};return s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsx("h1",{className:"mb-4 text-2xl font-bold",children:"Поиск по фото"}),t&&s.jsxs("div",{className:"mb-2 text-xs text-muted-foreground",children:["Рекомендации будут персонализированы под ваши параметры: рост ",t.height||"-"," см, вес ",t.weight||"-"," кг, грудь ",t.chest||"-"," см, талия ",t.waist||"-"," см, бёдра ",t.hips||"-"," см"]}),s.jsx(j,{onPhotoSelected:l,currentPhoto:n}),m&&s.jsx("div",{children:"Загрузка..."}),s.jsx("div",{className:"grid grid-cols-2 gap-4 mt-4",children:e.map(r=>s.jsx(x,{to:`/items/${r.id}`,className:"block",children:s.jsx(y,{children:s.jsx(w,{children:s.jsx("div",{children:r.name})})})},r.id))})]})};export{J as default};
