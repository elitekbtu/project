import{j as p}from"./ui-DmaJfU4R.js";import{r as s}from"./router-YsGj19cs.js";import{M as N,i as S,u as I,P as W,c as _,b as D,L as H,m as K}from"./proxy-OF6tZF67.js";class T extends s.Component{getSnapshotBeforeUpdate(a){const t=this.props.childRef.current;if(t&&a.isPresent&&!this.props.isPresent){const r=t.offsetParent,d=S(r)&&r.offsetWidth||0,o=this.props.sizeRef.current;o.height=t.offsetHeight||0,o.width=t.offsetWidth||0,o.top=t.offsetTop,o.left=t.offsetLeft,o.right=d-o.width-o.left}return null}componentDidUpdate(){}render(){return this.props.children}}function U({children:n,isPresent:a,anchorX:t}){const r=s.useId(),d=s.useRef(null),o=s.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:f}=s.useContext(N);return s.useInsertionEffect(()=>{const{width:g,height:i,top:x,left:e,right:l}=o.current;if(a||!d.current||!g||!i)return;const h=t==="left"?`left: ${e}`:`right: ${l}`;d.current.dataset.motionPopId=r;const c=document.createElement("style");return f&&(c.nonce=f),document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${g}px !important;
            height: ${i}px !important;
            ${h}px !important;
            top: ${x}px !important;
          }
        `),()=>{document.head.contains(c)&&document.head.removeChild(c)}},[a]),p.jsx(T,{isPresent:a,childRef:d,sizeRef:o,children:s.cloneElement(n,{ref:d})})}const q=({children:n,initial:a,isPresent:t,onExitComplete:r,custom:d,presenceAffectsLayout:o,mode:f,anchorX:g})=>{const i=I(A),x=s.useId();let e=!0,l=s.useMemo(()=>(e=!1,{id:x,initial:a,isPresent:t,custom:d,onExitComplete:h=>{i.set(h,!0);for(const c of i.values())if(!c)return;r&&r()},register:h=>(i.set(h,!1),()=>i.delete(h))}),[t,i,r]);return o&&e&&(l={...l}),s.useMemo(()=>{i.forEach((h,c)=>i.set(c,!1))},[t]),s.useEffect(()=>{!t&&!i.size&&r&&r()},[t]),f==="popLayout"&&(n=p.jsx(U,{isPresent:t,anchorX:g,children:n})),p.jsx(W.Provider,{value:l,children:n})};function A(){return new Map}const w=n=>n.key||"";function M(n){const a=[];return s.Children.forEach(n,t=>{s.isValidElement(t)&&a.push(t)}),a}const B=({children:n,custom:a,initial:t=!0,onExitComplete:r,presenceAffectsLayout:d=!0,mode:o="sync",propagate:f=!1,anchorX:g="left"})=>{const[i,x]=_(f),e=s.useMemo(()=>M(n),[n]),l=f&&!i?[]:e.map(w),h=s.useRef(!0),c=s.useRef(e),y=I(()=>new Map),[k,L]=s.useState(e),[C,$]=s.useState(e);D(()=>{h.current=!1,c.current=e;for(let m=0;m<C.length;m++){const u=w(C[m]);l.includes(u)?y.delete(u):y.get(u)!==!0&&y.set(u,!1)}},[C,l.length,l.join("-")]);const j=[];if(e!==k){let m=[...e];for(let u=0;u<C.length;u++){const b=C[u],P=w(b);l.includes(P)||(m.splice(u,0,b),j.push(b))}return o==="wait"&&j.length&&(m=j),$(M(m)),L(e),null}const{forceRender:E}=s.useContext(H);return p.jsx(p.Fragment,{children:C.map(m=>{const u=w(m),b=f&&!i?!1:e===C||l.includes(u),P=()=>{if(y.has(u))y.set(u,!0);else return;let v=!0;y.forEach(z=>{z||(v=!1)}),v&&(E==null||E(),$(c.current),f&&(x==null||x()),r&&r())};return p.jsx(q,{isPresent:b,initial:!h.current||t?void 0:!1,custom:a,presenceAffectsLayout:d,mode:o,onExitComplete:b?void 0:P,anchorX:g,children:m},u)})})},R=1e4,X=({images:n,className:a="",aspectClassName:t="aspect-square"})=>{const[[r,d],o]=s.useState([0,0]);if(n.length===0)return null;const f=(r%n.length+n.length)%n.length,g={enter:e=>({x:e>0?300:-300,opacity:0}),center:{x:0,opacity:1},exit:e=>({x:e<0?300:-300,opacity:0})},i=e=>{o([r+e,e])},x=n.map(e=>e.startsWith("/uploads/")?`${window.location.origin}${e}`:e);return p.jsxs("div",{className:`relative overflow-hidden rounded-md border border-border bg-background ${t} ${a}`,children:[p.jsx(B,{custom:d,initial:!1,children:p.jsx(K.img,{src:x[f],custom:d,variants:g,initial:"enter",animate:"center",exit:"exit",transition:{x:{type:"spring",stiffness:300,damping:30},opacity:{duration:.2}},drag:"x",dragConstraints:{left:0,right:0},dragElastic:.2,onDragEnd:(e,{offset:l,velocity:h})=>{const c=Math.abs(l.x)*h.x;c<-R?i(1):c>R&&i(-1)},className:"h-full w-full object-contain select-none"},f)}),n.length>1&&p.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex justify-center gap-1 rounded-full bg-black/30 px-2 py-1 backdrop-blur-sm",children:n.map((e,l)=>p.jsx("span",{className:`block h-1.5 w-1.5 rounded-full transition-colors ${l===f?"bg-white/90":"bg-white/40"}`},l))})]})};export{X as I};
