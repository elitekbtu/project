import{j as e}from"./ui-Cqf_O7uz.js";import{r as n}from"./router-YsGj19cs.js";import{B as _}from"./button-D4DJKXVl.js";import{I as E}from"./input-CPWPjeQo.js";import{L as S}from"./label-DMmfaKU4.js";import{B as F}from"./badge-DZ0IvmWb.js";import{C as h,d as u,a as C,b as k,c as $}from"./card-UwrtftrB.js";import{S as ae,a as re,b as le,c as ie,d as P}from"./select-DOTyNBHD.js";import{u as Ce}from"./use-toast-aHRkQ04f.js";import{c as R}from"./utils-CytzSlOG.js";import{c as N}from"./index-DUoZO1f1.js";import{m as Q}from"./proxy-kgKBpva2.js";import{C as W,a as ne}from"./circle-x-DfXG8zVP.js";import{L as G}from"./loader-circle-yzSCNo-f.js";import{R as ke}from"./refresh-cw-uUutlnOJ.js";import{P as ce}from"./package-Mme0kKEa.js";import{T as _e}from"./trending-up-CrVmSKtv.js";import{B as Te,Z as X}from"./zap-B6DnQTV_.js";import{S as de}from"./search-DxfJQDsN.js";import{D as me}from"./download-D5yk2_82.js";import{c as J}from"./createLucideIcon-BcwDLXBm.js";import{I as Le}from"./info-DtijYQbe.js";import{S as Ee}from"./settings-QGB-4gMH.js";import{C as Fe}from"./clock-B5XmQ9i6.js";import"./vendor-BtP0CW_r.js";import"./index-BwobEAja.js";import"./check-Jm2HgjeV.js";/**
 * @license lucide-react v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=J("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=J("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=J("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Ie=async r=>(await N.post("/api/catalog/parse",r)).data,oe=async(r,x=10,c="kz",y)=>{let d=`/api/catalog/parse-simple?query=${encodeURIComponent(r)}&limit=${x}&domain=${c}`;return y!==void 0&&(d+=`&page=${y}`),(await N.post(d)).data},Ue=async()=>(await N.post("/api/catalog/test-chain")).data,qe=async(r="jeans",x=5,c="kz")=>(await N.post(`/api/catalog/test-parser?query=${encodeURIComponent(r)}&limit=${x}&domain=${c}`)).data,ue=async r=>(await N.get(`/api/catalog/tasks/${r}/status`)).data,De=async r=>{await N.delete(`/api/catalog/tasks/${r}`)},Ae=async()=>(await N.get("/api/catalog/tasks")).data,ge=async()=>(await N.get("/api/catalog/stats")).data,xe=async r=>(await N.get(`/api/catalog/tasks/${r}/result`)).data,he=async(r,x,c=2e3,y=3e5)=>{const d=Date.now();for(;Date.now()-d<y;){const v=await ue(r);if(x&&x(v),v.state==="SUCCESS"||v.state==="FAILURE")return v;await new Promise(g=>setTimeout(g,c))}throw new Error("Task timeout")},ze=async()=>{try{return await ge(),!0}catch(r){return console.error("Parsing system health check failed:",r),!1}},us=()=>{const[r,x]=n.useState(""),[c,y]=n.useState(20),[d,v]=n.useState("kz"),[g,pe]=n.useState(null),[q,T]=n.useState([]),[D,je]=n.useState([]),[p,fe]=n.useState(null),[w,A]=n.useState("parser"),[b,K]=n.useState(!1),[I,Ne]=n.useState(1),[B,ye]=n.useState(1),[H,z]=n.useState([]),[L,Y]=n.useState(!1),{toast:j}=Ce(),O=n.useRef();n.useEffect(()=>(ee(),V(),Z(),O.current=setInterval(()=>{ve(),Z()},3e3),()=>{O.current&&clearInterval(O.current)}),[]);const ee=async()=>{const s=await ze();pe(s),s||j({variant:"destructive",title:"–°–∏—Å—Ç–µ–º–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞",description:"–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ backend —Å–µ—Ä–≤–∏—Å–∞"})},V=async()=>{try{const s=await ge();fe(s)}catch(s){console.error("Failed to load catalog stats:",s)}},Z=async()=>{try{const s=await Ae();je(s)}catch(s){console.error("Failed to load active tasks:",s)}},ve=async()=>{const s=await Promise.all(q.map(async i=>{try{const t=await ue(i.id);return{...i,status:t}}catch(t){return console.error(`Failed to update task ${i.id}:`,t),i}}));T(s);const a=new Date,l=s.filter(i=>i.status.state==="SUCCESS"||i.status.state==="FAILURE"?a.getTime()-i.startTime.getTime()<3e4:!0);l.length!==s.length&&T(l)},M=async s=>{if(!r.trim()&&s!=="test"&&s!=="test-parser"){j({variant:"destructive",title:"–û—à–∏–±–∫–∞",description:"–í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å"});return}K(!0);try{let a;switch(s){case"full":a=await Ie({query:r.trim(),limit:c,domain:d});break;case"simple":a=await oe(r.trim(),c,d);break;case"test":a=await Ue();break;case"test-parser":a=await qe(r.trim()||"jeans",c,d);break}const l={id:a.task_id,query:s==="test"?"Test Chain":s==="test-parser"?`Test Parser: ${r.trim()||"jeans"}`:r.trim(),domain:d,limit:c,type:s,status:{task_id:a.task_id,state:"PENDING"},startTime:new Date};T(i=>[...i,l]),j({title:"–ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–ø—É—â–µ–Ω",description:`–ó–∞–¥–∞—á–∞ ${a.task_id} –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –æ—á–µ—Ä–µ–¥—å`,className:"border-0 bg-blue-500 text-white shadow-lg"}),he(a.task_id,i=>{T(t=>t.map(m=>m.id===a.task_id?{...m,status:i}:m))}).then(async i=>{if(i.state==="SUCCESS"){try{const t=await xe(a.task_id);T(m=>m.map(o=>o.id===a.task_id?{...o,result:t}:o))}catch(t){console.error("Failed to get task result:",t)}j({title:"–ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω",description:`–ó–∞–¥–∞—á–∞ ${a.task_id} –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ`,className:"border-0 bg-green-500 text-white shadow-lg"}),V()}else j({variant:"destructive",title:"–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞",description:`–ó–∞–¥–∞—á–∞ ${a.task_id} –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π`})}).catch(i=>{console.error("Task monitoring error:",i)})}catch(a){j({variant:"destructive",title:"–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞",description:a.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥"})}finally{K(!1)}},we=async()=>{if(!r.trim()||I<1||B<I){j({variant:"destructive",title:"–û—à–∏–±–∫–∞",description:"–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∏ –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü"});return}Y(!0),z([]);const s=[];for(let a=I;a<=B;a++)try{const l=await oe(r.trim(),c,d,a),i={id:l.task_id,query:`${r.trim()} (—Å—Ç—Ä. ${a})`,domain:d,limit:c,type:"page",status:{task_id:l.task_id,state:"PENDING"},startTime:new Date};s.push(i),he(l.task_id,t=>{z(m=>m.map(o=>o.id===l.task_id?{...o,status:t}:o))}).then(async t=>{if(t.state==="SUCCESS")try{const m=await xe(l.task_id);z(o=>o.map(f=>f.id===l.task_id?{...f,result:m}:f))}catch{}})}catch(l){j({variant:"destructive",title:`–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ (—Å—Ç—Ä. ${a})`,description:l.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥"})}z(s),Y(!1)},be=async s=>{try{await De(s),T(a=>a.filter(l=>l.id!==s)),j({title:"–ó–∞–¥–∞—á–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞",description:`–ó–∞–¥–∞—á–∞ ${s} –±—ã–ª–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞`,className:"border-0 bg-yellow-500 text-white shadow-lg"})}catch(a){j({variant:"destructive",title:"–û—à–∏–±–∫–∞ –æ—Ç–º–µ–Ω—ã",description:a.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É"})}},se=s=>{switch(s){case"PENDING":return e.jsx(Fe,{className:"h-4 w-4 text-yellow-500"});case"PROGRESS":return e.jsx(G,{className:"h-4 w-4 text-blue-500 animate-spin"});case"SUCCESS":return e.jsx(W,{className:"h-4 w-4 text-green-500"});case"FAILURE":return e.jsx(ne,{className:"h-4 w-4 text-red-500"});default:return e.jsx(Re,{className:"h-4 w-4 text-gray-500"})}},te=s=>{switch(s){case"PENDING":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"PROGRESS":return"bg-blue-100 text-blue-800 border-blue-200";case"SUCCESS":return"bg-green-100 text-green-800 border-green-200";case"FAILURE":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},Se=s=>{const l=Math.floor((new Date().getTime()-s.getTime())/1e3);return l<60?`${l}—Å`:l<3600?`${Math.floor(l/60)}–º ${l%60}—Å`:`${Math.floor(l/3600)}—á ${Math.floor(l%3600/60)}–º`};return e.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight text-foreground",children:"üöÄ –ü–∞—Ä—Å–µ—Ä —Ç–æ–≤–∞—Ä–æ–≤"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–º–ø–æ—Ä—Ç —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ Lamoda —Å –ò–ò –æ–±—Ä–∞–±–æ—Ç–∫–æ–π"})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx(F,{variant:g===!0?"default":g===!1?"destructive":"secondary",className:"flex items-center gap-1 text-xs sm:text-sm",children:g===!0?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞"}),e.jsx("span",{className:"sm:hidden",children:"–ì–æ—Ç–æ–≤"})]}):g===!1?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:"–°–∏—Å—Ç–µ–º–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞"}),e.jsx("span",{className:"sm:hidden",children:"–û—à–∏–±–∫–∞"})]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"–ü—Ä–æ–≤–µ—Ä–∫–∞..."}),e.jsx("span",{className:"sm:hidden",children:"–ü—Ä–æ–≤–µ—Ä–∫–∞"})]})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>{ee(),V(),Z()},children:e.jsx(ke,{className:"h-4 w-4"})})]})]}),p&&e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx(h,{children:e.jsx(u,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold",children:p.total_items.toLocaleString()})]}),e.jsx(ce,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-500"})]})})}),e.jsx(h,{children:e.jsx(u,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"–ó–∞ –Ω–µ–¥–µ–ª—é"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold",children:p.recent_items_week.toLocaleString()})]}),e.jsx(_e,{className:"h-6 w-6 sm:h-8 sm:w-8 text-green-500"})]})})}),e.jsx(h,{children:e.jsx(u,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"–°—Ä. —Ü–µ–Ω–∞"}),e.jsxs("p",{className:"text-lg sm:text-2xl font-bold",children:[Math.round(p.price_range.average).toLocaleString(),"‚Ç∏"]})]}),e.jsx(Te,{className:"h-6 w-6 sm:h-8 sm:w-8 text-purple-500"})]})})}),e.jsx(h,{children:e.jsx(u,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold",children:D.length})]}),e.jsx(X,{className:"h-6 w-6 sm:h-8 sm:w-8 text-orange-500"})]})})})]}),e.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap space-y-1 sm:space-y-0 sm:space-x-1 bg-muted p-1 rounded-lg",children:[e.jsxs("button",{onClick:()=>A("parser"),className:R("flex-1 px-2 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors",w==="parser"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsx("span",{className:"hidden sm:inline",children:"–ü–∞—Ä—Å–µ—Ä"}),e.jsx("span",{className:"sm:hidden",children:"–ü–∞—Ä—Å–µ—Ä"})]}),e.jsxs("button",{onClick:()=>A("pages"),className:R("flex-1 px-2 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors",w==="pages"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsx("span",{className:"hidden sm:inline",children:"–ü–∞—Ä—Å–∏–Ω–≥ –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º"}),e.jsx("span",{className:"sm:hidden",children:"–°—Ç—Ä–∞–Ω–∏—Ü—ã"})]}),e.jsxs("button",{onClick:()=>A("tasks"),className:R("flex-1 px-2 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors",w==="tasks"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsxs("span",{className:"hidden sm:inline",children:["–ó–∞–¥–∞—á–∏ (",D.length,")"]}),e.jsx("span",{className:"sm:hidden",children:"–ó–∞–¥–∞—á–∏"})]}),e.jsxs("button",{onClick:()=>A("analytics"),className:R("flex-1 px-2 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-md transition-colors",w==="analytics"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),children:[e.jsx("span",{className:"hidden sm:inline",children:"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞"}),e.jsx("span",{className:"sm:hidden",children:"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞"})]})]}),w==="parser"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(h,{children:[e.jsxs(C,{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5"}),"–ù–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥"]}),e.jsx($,{children:"–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Lamoda"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"query",children:"–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å"}),e.jsx(E,{id:"query",placeholder:"nike –∫—Ä–æ—Å—Å–æ–≤–∫–∏, –ø–ª–∞—Ç—å–µ, –¥–∂–∏–Ω—Å—ã...",value:r,onChange:s=>x(s.target.value),disabled:b})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"domain",children:"–î–æ–º–µ–Ω"}),e.jsxs(ae,{value:d,onValueChange:s=>v(s),children:[e.jsx(re,{children:e.jsx(le,{})}),e.jsxs(ie,{children:[e.jsx(P,{value:"kz",children:"üá∞üáø –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω (lamoda.kz)"}),e.jsx(P,{value:"ru",children:"üá∑üá∫ –†–æ—Å—Å–∏—è (lamoda.ru)"}),e.jsx(P,{value:"by",children:"üáßüáæ –ë–µ–ª–∞—Ä—É—Å—å (lamoda.by)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"limit",children:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤"}),e.jsx(E,{id:"limit",type:"number",min:"1",max:"100",value:c,onChange:s=>y(Number(s.target.value)),disabled:b})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-3 pt-4",children:[e.jsxs(_,{onClick:()=>M("full"),disabled:b||!g,className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:b?"–ó–∞–ø—É—Å–∫...":"–ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ + –ò–ò + –ë–î"}),e.jsx("span",{className:"sm:hidden",children:b?"–ó–∞–ø—É—Å–∫...":"–ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥"})]}),e.jsxs(_,{variant:"outline",onClick:()=>M("simple"),disabled:b||!g,className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"–¢–æ–ª—å–∫–æ –ø–∞—Ä—Å–∏–Ω–≥"}),e.jsx("span",{className:"sm:hidden",children:"–ü–∞—Ä—Å–∏–Ω–≥"})]}),e.jsxs(_,{variant:"secondary",onClick:()=>M("test"),disabled:b||!g,className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx($e,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"–¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã"}),e.jsx("span",{className:"sm:hidden",children:"–¢–µ—Å—Ç"})]}),e.jsxs(_,{variant:"outline",onClick:()=>M("test-parser"),disabled:b||!g,className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"–¢–µ—Å—Ç –ø–∞—Ä—Å–µ—Ä–∞"}),e.jsx("span",{className:"sm:hidden",children:"–¢–µ—Å—Ç –ø–∞—Ä—Å–µ—Ä–∞"})]})]}),e.jsx("div",{className:"rounded-lg bg-blue-50 p-4 dark:bg-blue-950/20",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Le,{className:"h-5 w-5 text-blue-500 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-blue-900 dark:text-blue-100",children:"–†–µ–∂–∏–º—ã –ø–∞—Ä—Å–∏–Ω–≥–∞:"}),e.jsxs("ul",{className:"mt-1 space-y-1 text-blue-700 dark:text-blue-300",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"–ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥:"})," –ü–∞—Ä—Å–∏–Ω–≥ ‚Üí –ò–ò –æ–±—Ä–∞–±–æ—Ç–∫–∞ ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"–¢–æ–ª—å–∫–æ –ø–∞—Ä—Å–∏–Ω–≥:"})," –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"–¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã:"})," –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"–¢–µ—Å—Ç –ø–∞—Ä—Å–µ—Ä–∞:"})," –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å Lamoda"]})]})]})]})})]})]}),q.length>0&&e.jsxs(h,{children:[e.jsx(C,{children:e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5 animate-spin"}),"–í—ã–ø–æ–ª–Ω—è—é—â–∏–µ—Å—è –∑–∞–¥–∞—á–∏ (",q.length,")"]})}),e.jsx(u,{children:e.jsx("div",{className:"space-y-4",children:q.map(s=>{var a,l,i;return e.jsxs(Q.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[se(s.status.state),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium text-sm sm:text-base truncate",children:s.query}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:[s.domain.toUpperCase()," ‚Ä¢ ",s.limit," —Ç–æ–≤–∞—Ä–æ–≤ ‚Ä¢ ",Se(s.startTime)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:R("text-xs",te(s.status.state)),children:s.status.state}),(s.status.state==="PENDING"||s.status.state==="PROGRESS")&&e.jsx(_,{variant:"outline",size:"sm",onClick:()=>be(s.id),children:e.jsx(Pe,{className:"h-3 w-3"})})]})]}),((a=s.status.meta)==null?void 0:a.status)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.status.meta.status}),((l=s.status.meta)==null?void 0:l.progress)!==void 0&&e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 dark:bg-gray-700",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${s.status.meta.progress}%`}})}),s.status.state==="SUCCESS"&&s.status.result&&e.jsxs("div",{className:"text-sm text-green-600 dark:text-green-400",children:["‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: ",s.status.result.success_count||0," —Ç–æ–≤–∞—Ä–æ–≤"]}),s.status.state==="SUCCESS"&&((i=s.result)==null?void 0:i.result)&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-green-600",children:"–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["–ö–∞—á–µ—Å—Ç–≤–æ: ",(s.result.result.quality_score*100).toFixed(0),"%"]}),e.jsx("span",{children:"‚Ä¢"}),e.jsxs("span",{children:["–í—Ä–µ–º—è: ",s.result.result.parsing_time.toFixed(1),"—Å"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 max-h-96 overflow-y-auto",children:s.result.result.products.slice(0,6).map((t,m)=>e.jsxs("div",{className:"border rounded-lg p-2 sm:p-3 space-y-2 bg-white dark:bg-gray-800",children:[e.jsxs("div",{className:"aspect-square w-full bg-gray-100 dark:bg-gray-700 rounded-md overflow-hidden",children:[t.image_url?e.jsx("img",{src:`/api/catalog/image-proxy?url=${encodeURIComponent(t.image_url)}`,alt:t.name,className:"w-full h-full object-cover",onError:o=>{var U;const f=o.target;f.style.display="none",(U=f.nextElementSibling)==null||U.classList.remove("hidden")}}):null,e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs sm:text-sm hidden",children:"–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-xs sm:text-sm line-clamp-2",title:t.name,children:t.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.brand}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-semibold text-xs sm:text-sm",children:[t.price.toLocaleString(),"‚Ç∏"]}),t.old_price&&t.old_price>t.price&&e.jsxs("span",{className:"text-xs text-red-500 line-through",children:[t.old_price.toLocaleString(),"‚Ç∏"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"–ö–∞—á–µ—Å—Ç–≤–æ:"}),e.jsxs("span",{className:"text-xs font-medium text-green-600",children:[(t.parse_quality*100).toFixed(0),"%"]})]}),t.image_urls&&t.image_urls.length>1&&e.jsxs("p",{className:"text-xs text-blue-600",children:["+",t.image_urls.length-1," –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"]})]})]},m))}),s.result.result.products.length>6&&e.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:["–ò –µ—â–µ ",s.result.result.products.length-6," —Ç–æ–≤–∞—Ä–æ–≤..."]})]}),s.status.state==="FAILURE"&&e.jsxs("div",{className:"text-sm text-red-600 dark:text-red-400",children:["‚ùå –û—à–∏–±–∫–∞: ",s.status.traceback||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"]})]},s.id)})})})]})]}),w==="pages"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(h,{children:[e.jsxs(C,{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),"–ü–∞—Ä—Å–∏–Ω–≥ –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º Lamoda"]}),e.jsx($,{children:"–£–∫–∞–∂–∏—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü –∏ –ø–æ–ª—É—á–∏—Ç–µ –º–∞–∫—Å–∏–º—É–º —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Å Lamoda. –ö–∞–∂–¥—ã–π –∑–∞–ø—É—Å–∫ ‚Äî –Ω–æ–≤—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã!"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"query-pages",children:"–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å"}),e.jsx(E,{id:"query-pages",placeholder:"nike –∫—Ä–æ—Å—Å–æ–≤–∫–∏, –ø–ª–∞—Ç—å–µ, –¥–∂–∏–Ω—Å—ã...",value:r,onChange:s=>x(s.target.value),disabled:L})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"domain-pages",children:"–î–æ–º–µ–Ω"}),e.jsxs(ae,{value:d,onValueChange:s=>v(s),children:[e.jsx(re,{children:e.jsx(le,{})}),e.jsxs(ie,{children:[e.jsx(P,{value:"kz",children:"üá∞üáø –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω (lamoda.kz)"}),e.jsx(P,{value:"ru",children:"üá∑üá∫ –†–æ—Å—Å–∏—è (lamoda.ru)"}),e.jsx(P,{value:"by",children:"üáßüáæ –ë–µ–ª–∞—Ä—É—Å—å (lamoda.by)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{htmlFor:"limit-pages",children:"–¢–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É"}),e.jsx(E,{id:"limit-pages",type:"number",min:"1",max:"100",value:c,onChange:s=>y(Number(s.target.value)),disabled:L})]}),e.jsxs("div",{className:"flex gap-2 items-end",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(S,{htmlFor:"page-from",children:"–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å"}),e.jsx(E,{id:"page-from",type:"number",min:"1",value:I,onChange:s=>Ne(Number(s.target.value)),disabled:L})]}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(S,{htmlFor:"page-to",children:"–ø–æ"}),e.jsx(E,{id:"page-to",type:"number",min:I,value:B,onChange:s=>ye(Number(s.target.value)),disabled:L})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs(_,{onClick:we,disabled:L||!g,className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),L?"–ó–∞–ø—É—Å–∫...":"–ü–∞—Ä—Å–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω —Å—Ç—Ä–∞–Ω–∏—Ü"]})})]})]}),H.length>0&&e.jsxs(h,{children:[e.jsx(C,{children:e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5 animate-spin"}),"–ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º (",H.length,")"]})}),e.jsx(u,{children:e.jsx("div",{className:"space-y-4",children:H.map(s=>{var a,l,i;return e.jsxs(Q.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"border rounded-lg p-4 space-y-3 bg-gradient-to-br from-blue-50 to-purple-50",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[se(s.status.state),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium text-sm sm:text-base truncate",children:s.query}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.domain.toUpperCase()," ‚Ä¢ ",s.limit," —Ç–æ–≤–∞—Ä–æ–≤"]})]})]}),e.jsx(F,{className:R("text-xs",te(s.status.state)),children:s.status.state})]}),((a=s.status.meta)==null?void 0:a.status)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.status.meta.status}),((l=s.status.meta)==null?void 0:l.progress)!==void 0&&e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 dark:bg-gray-700",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${s.status.meta.progress}%`}})}),s.status.state==="SUCCESS"&&((i=s.result)==null?void 0:i.result)&&e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-700 text-sm",children:[e.jsx(W,{className:"h-4 w-4"}),e.jsxs("span",{children:["–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤: ",s.result.result.success_count]}),e.jsxs("span",{className:"text-muted-foreground",children:["/ –í—Å–µ–≥–æ: ",s.result.result.total_found]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 max-h-80 overflow-y-auto",children:s.result.result.products.slice(0,6).map((t,m)=>e.jsxs("div",{className:"border rounded-lg p-2 sm:p-3 space-y-2 bg-white dark:bg-gray-800",children:[e.jsxs("div",{className:"aspect-square w-full bg-gray-100 dark:bg-gray-700 rounded-md overflow-hidden",children:[t.image_url?e.jsx("img",{src:`/api/catalog/image-proxy?url=${encodeURIComponent(t.image_url)}`,alt:t.name,className:"w-full h-full object-cover",onError:o=>{var U;const f=o.target;f.style.display="none",(U=f.nextElementSibling)==null||U.classList.remove("hidden")}}):null,e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs sm:text-sm hidden",children:"–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-medium text-xs sm:text-sm line-clamp-2",title:t.name,children:t.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.brand}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-semibold text-xs sm:text-sm",children:[t.price.toLocaleString(),"‚Ç∏"]}),t.old_price&&t.old_price>t.price&&e.jsxs("span",{className:"text-xs text-red-500 line-through",children:[t.price.toLocaleString(),"‚Ç∏"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"–ö–∞—á–µ—Å—Ç–≤–æ:"}),e.jsxs("span",{className:"text-xs font-medium text-green-600",children:[(t.parse_quality*100).toFixed(0),"%"]})]}),t.image_urls&&t.image_urls.length>1&&e.jsxs("p",{className:"text-xs text-blue-600",children:["+",t.image_urls.length-1," –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π"]})]})]},m))}),s.result.result.products.length>6&&e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["–ò –µ—â–µ ",s.result.result.products.length-6," —Ç–æ–≤–∞—Ä–æ–≤..."]})]}),s.status.state==="FAILURE"&&e.jsxs("div",{className:"text-sm text-red-600 dark:text-red-400",children:["‚ùå –û—à–∏–±–∫–∞: ",s.status.traceback||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"]})]},s.id)})})})]})]}),w==="tasks"&&e.jsxs(h,{children:[e.jsxs(C,{children:[e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5"}),"–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Å–∏—Å—Ç–µ–º—ã"]}),e.jsx($,{children:"–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤—ã–ø–æ–ª–Ω—è—é—â–∏—Ö—Å—è –∑–∞–¥–∞—á –≤ Celery"})]}),e.jsx(u,{children:D.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ce,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á"})]}):e.jsx("div",{className:"space-y-3",children:D.map(s=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Worker: ",s.worker," ‚Ä¢ Started: ",new Date(s.time_start).toLocaleString()]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["ID: ",s.task_id]})]}),e.jsx(F,{variant:"outline",children:"–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è"})]})},s.task_id))})})]}),w==="analytics"&&p&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(h,{children:[e.jsxs(C,{children:[e.jsx(k,{className:"text-lg sm:text-xl",children:"–¢–æ–ø –±—Ä–µ–Ω–¥–æ–≤"}),e.jsx($,{className:"text-sm",children:"–°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –±—Ä–µ–Ω–¥—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ"})]}),e.jsx(u,{children:e.jsx("div",{className:"space-y-3",children:p.top_brands.slice(0,5).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-full bg-primary/20 flex items-center justify-center text-xs font-medium flex-shrink-0",children:a+1}),e.jsx("span",{className:"font-medium text-sm sm:text-base truncate",children:s.brand})]}),e.jsx(F,{variant:"outline",className:"text-xs sm:text-sm flex-shrink-0",children:s.count.toLocaleString()})]},s.brand))})})]}),e.jsxs(h,{children:[e.jsxs(C,{children:[e.jsx(k,{className:"text-lg sm:text-xl",children:"–¢–æ–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–π"}),e.jsx($,{className:"text-sm",children:"–°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤"})]}),e.jsx(u,{children:e.jsx("div",{className:"space-y-3",children:p.top_categories.slice(0,5).map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-full bg-green-500/20 flex items-center justify-center text-xs font-medium flex-shrink-0",children:a+1}),e.jsx("span",{className:"font-medium text-sm sm:text-base truncate",children:s.category})]}),e.jsx(F,{variant:"outline",className:"text-xs sm:text-sm flex-shrink-0",children:s.count.toLocaleString()})]},s.category))})})]})]}),e.jsxs(h,{children:[e.jsxs(C,{children:[e.jsx(k,{className:"text-lg sm:text-xl",children:"–¶–µ–Ω–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω"}),e.jsx($,{className:"text-sm",children:"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ü–µ–Ω–∞–º —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ"})]}),e.jsx(u,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:[Math.round(p.price_range.min).toLocaleString(),"‚Ç∏"]}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:[Math.round(p.price_range.average).toLocaleString(),"‚Ç∏"]}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-purple-600",children:[Math.round(p.price_range.max).toLocaleString(),"‚Ç∏"]}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞"})]})]})})]})]})]})};export{us as default};
